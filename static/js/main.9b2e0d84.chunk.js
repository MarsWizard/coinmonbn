(this.webpackJsonpmpui=this.webpackJsonpmpui||[]).push([[0],{15:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(6),i=n.n(a),r=(n(15),n(3)),o=n(7),l=n(8),d=n(2),h=n(10),b=n(9),u=n(5),f=n.n(u),p=n(0),j=n(17),y=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var c;Object(o.a)(this,n),c=t.call(this,e);for(var s={},a=["ETH","BTC"],i=0,r=a;i<r.length;i++){s[r[i]]=null}return c.state={count:90,prices:s,symbols:a,future_contracts:[{contract_code:"ETH_CW",symbol:"ETH"},{contract_code:"ETH_NW",symbol:"ETH"},{contract_code:"ETH_CQ",symbol:"ETH"},{contract_code:"ETH_NQ",symbol:"ETH"},{contract_code:"BTC_CW",symbol:"BTC"},{contract_code:"BTC_NW",symbol:"BTC"},{contract_code:"BTC_CQ",symbol:"BTC"},{contract_code:"BTC_NQ",symbol:"BTC"}]},c.sendMessage=c.sendMessage.bind(Object(d.a)(c)),c.subscribe=c.subscribe.bind(Object(d.a)(c)),c.updatePrice=c.updatePrice.bind(Object(d.a)(c)),c.sendMessageSwap=c.sendMessageSwap.bind(Object(d.a)(c)),c}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e,t=this,n=Object(r.a)(this.state.symbols);try{for(n.s();!(e=n.n()).done;){var c=e.value,s=new URL("https://api.hbdm.com/api/v1/contract_contract_info");s.search=new URLSearchParams({symbol:c}),fetch(s).then((function(e){return e.json()})).then((function(e){t.setState({contacts:e})})).catch(console.log)}}catch(a){n.e(a)}finally{n.f()}}},{key:"handleData",value:function(e){var t=this.sendMessage,n=this;e.arrayBuffer().then((function(e){var c=j.inflate(e,{to:"string"}),s=JSON.parse(c);if(s.ping)t(JSON.stringify({pong:s.ping}));else if(s.tick){var a=s.ch.match(/market\.([\w_]+)\.kline\.1min/);if(a){var i=a[1];n.updatePrice(i,s.tick.close)}}}))}},{key:"updatePrice",value:function(e,t){var n=this.state.prices;n[e]=t,this.setState({prices:n})}},{key:"subscribe",value:function(){var e,t=Object(r.a)(this.state.symbols);try{for(t.s();!(e=t.n()).done;)for(var n=e.value,c=0,s=["CW","NW","CQ","NQ"];c<s.length;c++){var a=s[c];this.sendMessage(JSON.stringify({sub:"market.".concat(n,"_").concat(a,".kline.1min"),id:"".concat(n,"_").concat(a)}))}}catch(i){t.e(i)}finally{t.f()}}},{key:"handleOpen",value:function(){this.subscribe()}},{key:"sendMessage",value:function(e){this.refWebSocket.sendMessage(e)}},{key:"handleSwapOpen",value:function(){var e,t=new Set,n=Object(r.a)(this.state.future_contracts);try{for(n.s();!(e=n.n()).done;){var c=e.value;t.add(c.symbol)}}catch(d){n.e(d)}finally{n.f()}var s,a=Object(r.a)(t);try{for(a.s();!(s=a.n()).done;){var i=s.value,o="".concat(i,"-USD"),l="market.".concat(o,".kline.1min");this.sendMessageSwap(JSON.stringify({sub:l}))}}catch(d){a.e(d)}finally{a.f()}}},{key:"sendMessageSwap",value:function(e){this.ws_swap.sendMessage(e)}},{key:"handleSwapReceive",value:function(e){var t=this;e.arrayBuffer().then((function(e){var n=j.inflate(e,{to:"string"}),c=JSON.parse(n);if(c.ping)t.sendMessageSwap(JSON.stringify({pong:c.ping}));else if(c.tick){var s=c.ch.match(/market\.([\w]+)\-([\w+]+)\.kline\.1min/);if(s){var a=s[1];console.log(a),t.updatePrice(a,c.tick.close)}console.log(c)}else console.log(n)}))}},{key:"render",value:function(){var e=this,t=(this.state.symbols,this.state.future_contracts);return Object(p.jsxs)("div",{children:[Object(p.jsxs)("table",{children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Symbol"}),Object(p.jsx)("th",{children:"LastPrice"}),Object(p.jsx)("th",{children:"Spot"}),Object(p.jsx)("th",{children:"Spread Rate"})]})}),Object(p.jsx)("tbody",{children:t.map((function(t,n){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:t.contract_code}),Object(p.jsx)("td",{children:e.state.prices[t.contract_code]}),Object(p.jsx)("td",{children:e.state.prices[t.symbol]}),Object(p.jsx)("td",{children:(e.state.prices[t.contract_code]/e.state.prices[t.symbol]).toFixed(4)})]},t.contract_code)}))})]}),Object(p.jsx)(f.a,{url:"wss://api.btcgateway.pro/ws",onMessage:this.handleData.bind(this),debug:!0,onOpen:this.handleOpen.bind(this),ref:function(t){e.refWebSocket=t}}),Object(p.jsx)(f.a,{url:"wss://api.btcgateway.pro/swap-ws",onMessage:this.handleSwapReceive.bind(this),debug:!0,onOpen:this.handleSwapOpen.bind(this),ref:function(t){e.ws_swap=t}})]})}}]),n}(c.Component),g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),s(e),a(e),i(e)}))};i.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(y,{})}),document.getElementById("root")),g()}},[[18,1,2]]]);
//# sourceMappingURL=main.9b2e0d84.chunk.js.map